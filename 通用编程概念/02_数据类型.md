# æ•°æ®ç±»å‹

Rust ä¸­çš„å€¼éƒ½æ˜¯ç¡®å®šçš„ç±»å‹ï¼Œæ•°æ®ç±»å‹æè¿°äº†æ•°æ®çš„ç§ç±»ä»¥ä¾¿äº Rust çŸ¥é“å¦‚ä½•ä¸è¿™äº›æ•°æ®ä¸€èµ·å·¥ä½œï¼Œæœ¬ç« èŠ‚å°†ä»‹ç»ä¸¤ç§æ•°æ®ç±»å‹å­é›†ï¼šæ ‡é‡ï¼ˆ scalar ï¼‰å’Œå¤åˆï¼ˆ compound ï¼‰

Rust æ˜¯é™æ€ç±»å‹è¯­è¨€ï¼Œç¼–è¯‘æ—¶å¿…é¡»çŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹ï¼Œç¼–è¯‘å™¨é€šå¸¸å¯ä»¥æ ¹æ®å€¼åŠå…¶è¢«ä½¿ç”¨çš„æ–¹å¼æ¥æ¨æ–­ç±»å‹ï¼Œä½†å½“ç±»å‹å­˜åœ¨å¤šç§å¯èƒ½æ— æ³•æ¨æ–­æ—¶ï¼Œå¿…é¡»æ·»åŠ ç±»å‹æ³¨è§£ï¼š

```rust
let guess: u32 = "42".parse().expect("Not a number!");
```

å¦‚æœç¼ºå°‘ç±»å‹æ³¨è§£ï¼ŒRust ä¼šæ˜¾ç¤ºé”™è¯¯ï¼Œè¡¨ç¤ºç¼–è¯‘å™¨éœ€è¦æˆ‘ä»¬æä¾›æ›´å¤šä¿¡æ¯æ¥åˆ¤æ–­ä»£ç ä¸­æ‰€ä½¿ç”¨çš„ç±»å‹ï¼š

```rust
let guess: u32 = "42".parse().expect("Not a number!");
```

```shell
error[E0282]: type annotations needed
 --> src/main.rs:2:9
  |
2 |     let guess = "42".parse().expect("Not a number!");
  |         ^^^^^
  |         |
  |         cannot infer type for `_`
  |         consider giving `guess` a type
```

## æ ‡é‡ç±»å‹

ä»£è¡¨ä¸€ä¸ªå•ç‹¬çš„å€¼ï¼ŒRust æœ‰å››ç§ä¸»è¦çš„æ ‡é‡ç±»å‹ï¼šæ•´å‹ã€æµ®ç‚¹å‹ã€å¸ƒå°”å‹ã€å­—ç¬¦å‹ã€‚

### æ•´å‹

ä»¥ `u32` ç±»å‹ä¸ºä¾‹ï¼Œæ­¤ç±»å‹å£°æ˜è¡¨ç¤ºè¯¥ç±»å‹çš„å…³è”å€¼åº”å½“æ˜¯ä¸€ä¸ª 4 ä¸ªå­—èŠ‚ï¼ˆ32 ä½ï¼‰å¤§å°çš„æ— ç¬¦å·æ•´æ•°ï¼ˆæœ‰ç¬¦å·æ•´æ•°ç±»å‹ä»¥ `i` è€Œä¸æ˜¯ `u` å¼€å¤´ï¼‰ï¼ŒRust ä¸­çš„å†…ç½®æ•´æ•°ç±»å‹ï¼š

| Length | Signed | Unsigned |
| --- | --- | --- |
| 8-bit | i8 | u8 |
| 16-bit | i16 | u16 |
| 32-bit | i32 | u32 |
| 64-bit | i64 | u64 |
| 128-bit | i128 | u128 |
| arch | isize | usize |

`isize` å’Œ `usize` ç±»å‹ä¾èµ–äºç¨‹åºåœ¨ä½•ç§ç±»å‹çš„è®¡ç®—æœºä¸Šè¿è¡Œï¼š64 å¯¹åº” 64 ä½æ¶æ„ï¼Œ32 å¯¹åº” 32 ä½æ¶æ„ã€‚

Rust ä¸­çš„æ•´å‹å­—é¢é‡ï¼š

| Number literals | Example |
| --- | --- |
| Decimal | 98_222 |
| Hex | 0xff |
| Octal | 0o77 |
| Binary | 0b1111_0000 |
| Byte (u8 only) | b'A' |

ä»¥ä¸Šæ ¼å¼å‡é€‚ç”¨äºç¼–å†™æ•´æ•°å­—é¢é‡ã€‚æ³¨æ„ï¼Œæ‰€æœ‰æ•°å­—å­—é¢é‡é™¤äº†å­—èŠ‚å­—é¢é‡å¤–éƒ½å…è®¸ä½¿ç”¨ç±»å‹å‰ç¼€ï¼Œæ¯”å¦‚ `57u8` ï¼‰ä»¥åŠ `_` ä½œä¸ºå¯è§åˆ†éš”ï¼ˆ æ¯”å¦‚ `1_000` ï¼‰

çŸ¥é“å¦‚ä½•é€‰æ‹©æ•´æ•°ç±»å‹ï¼Ÿå¦‚æœä¸ç¡®å®šï¼Œä½¿ç”¨ Rust é»˜è®¤æ–¹æ¡ˆé€šå¸¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ï¼Œæ•´å‹ç±»å‹çš„é»˜è®¤ç±»å‹æ˜¯ `i32`ï¼Œå®ƒé€šå¸¸æ˜¯æœ€å¿«çš„ï¼Œå³ä½¿åœ¨ 64 ä½ç³»ç»Ÿä¸­ã€‚ä½¿ç”¨ `isize` è¿˜æ˜¯ `usize` çš„æƒ…å†µä¸»è¦å­˜åœ¨äºå¯¹æŸäº›é›†åˆè¿›è¡Œç´¢å¼•çš„æ—¶å€™ã€‚

#### æ•´å‹æº¢å‡º

`u8` ç±»å‹çš„å˜é‡å¯ä»¥å­˜å‚¨ä» 0 åˆ° 255 ä¹‹é—´çš„å€¼ã€‚å¦‚æœå°è¯•æ”¹å˜ u8 ç±»å‹å˜é‡ä¸ºèŒƒå›´ä¹‹å¤–çš„å€¼ï¼Œæ¯”å¦‚ 256ï¼Œå°†ä¼šå‘ç”Ÿæ•´å‹æº¢å‡ºã€‚Rust æœ‰ä¸€äº›æ¶‰åŠæ­¤è¡Œä¸ºçš„æœ‰è¶£è§„åˆ™ã€‚å½“åœ¨è°ƒè¯•æ¨¡å¼ä¸‹ç¼–è¯‘ä»£ç æ—¶ï¼Œå¦‚æœæœ‰æ­¤ç±»è¡Œä¸ºå‘ç”Ÿï¼ŒRust ä¼šå¯¹å¯¼è‡´ç¨‹åºè¿è¡Œæ—¶ Panic çš„æ•´å‹æº¢å‡ºè¡Œä¸ºè¿›è¡Œæ£€æŸ¥ã€‚

å½“ä½¿ç”¨ `--release` åœ¨å‘å¸ƒæ¨¡å¼ä¸‹ç¼–è¯‘ä»£ç ï¼ŒRust ä¸ä¼šåŒ…å«æ•´å‹æº¢å‡ºæ£€æŸ¥ï¼Œè€Œæ˜¯åœ¨å‘ç”Ÿæº¢å‡ºæ—¶å®æ–½ â€œtwoâ€™s complement wrappingâ€ã€‚ç®€å•æ¥è¯´ï¼Œæ¯”ç±»å‹èƒ½å¤ŸæŒæœ‰çš„æœ€å¤§å€¼è¿˜å¤§çš„å€¼èƒ½å¤ŸæŒæœ‰ â€œwrap aroundâ€ ç±»å‹æŒæœ‰çš„æœ€å°å€¼ã€‚ä»¥å‰é¢çš„ `u8` ä¸ºä¾‹ï¼Œ256 å˜ä¸º 0 ï¼Œ257 å˜ä¸º 1ï¼Œä»¥æ­¤ç±»æ¨ã€‚ç¨‹åºä¸ä¼š Panicï¼Œä½†æ˜¯å˜é‡å°†ä¼šæœ‰ä¸€ä¸ªéé¢„æœŸçš„å€¼ã€‚ä¾èµ–äºæ•´å‹æº¢å‡ºçš„åŒ…è£…è¡Œä¸ºè¢«è®¤ä¸ºæ˜¯é”™è¯¯ã€‚å¦‚æœæƒ³æ˜¾å¼è¿›è¡ŒåŒ…è£…ï¼Œå¯ä»¥ä½¿ç”¨æ ‡å‡†åº“ä¸­çš„ `Wrapping` ç±»å‹ã€‚

### æµ®ç‚¹å‹

å¯¹äºå¸¦æœ‰å°æ•°ç‚¹çš„æµ®ç‚¹ç±»å‹æ•°å­—ï¼ŒRust æä¾›ä¸¤ç§ä¸»è¦çš„ç±»å‹ï¼šå•ç²¾åº¦æµ®ç‚¹æ•° `f32`ï¼ˆ 32 ä½ ï¼‰ã€åŒå•ç²¾åº¦æµ®ç‚¹æ•° `f64` ï¼ˆ 64 ä½ï¼Œé»˜è®¤ç±»å‹ï¼Œå…¶åœ¨ç°ä»£ CPU ä¸Šçš„é€Ÿåº¦ä¸ f32 ç›¸å·®æ— å‡ ï¼Œä½†æ˜¯æä¾›çš„ç²¾åº¦æ›´é«˜ ï¼‰

```rust
fn main() {
    let x = 2.0; // f64

    let y: f32 = 3.0; // f32
}
```

### æ•°å­—è¿ç®—

Rust æ”¯æŒç”¨äºæ•°å­—ç±»å‹çš„åŸºç¡€æ•°å­¦è¿ç®—ï¼šåŠ ã€å‡ã€ä¹˜ã€é™¤ä»¥åŠå–ä½™

```rust
fn main() {
    // addition
    let sum = 5 + 10;

    // subtraction
    let difference = 95.5 - 4.3;

    // multiplication
    let product = 4 * 30;

    // division
    let quotient = 56.7 / 32.2;

    // remainder
    let remainder = 43 % 5;
}
```

### å¸ƒå°”ç±»å‹

ä¸å…¶å®ƒå¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸€æ ·ï¼ŒRust ä¸­çš„ Boolean ç±»å‹å…·æœ‰ `true` å’Œ `false` ä¸¤ä¸ªå¯èƒ½çš„å€¼ï¼Œå¹¶ä½¿ç”¨ `bool` æ¥å£°æ˜ã€‚

```rust
fn main() {
    let t = true;

    let f: bool = false; // with explicit type annotation
}
```

Rust ä¸­ä¸»è¦é€šè¿‡æ¡ä»¶æ¥ä½¿ç”¨å¸ƒå°”ç±»å‹ï¼Œæ¯”å¦‚ `if` è¡¨è¾¾å¼ã€‚

### å­—ç¬¦ç±»å‹

`char` ç±»å‹æ˜¯ Rust ä¸­æœ€åŸºæœ¬çš„å­—æ¯ç±»å‹ï¼Œæ³¨æ„ï¼Œä¸åŒäºå­—ç¬¦ä¸²å­—é¢é‡ï¼ˆ string ï¼‰ä½¿ç”¨åŒå¼•å·è¿›è¡Œå£°æ˜ï¼Œ`char` å­—é¢é‡é‡‡ç”¨å•å¼•å·å£°æ˜ã€‚

```rust
fn main() {
    let c = 'z';
    let z = 'â„¤';
    let heart_eyed_cat = 'ğŸ˜»';
}
```

Rust çš„å­—ç¬¦ç±»å‹å ç”¨ 4 ä¸ªå­—èŠ‚å¤§å°æ¥è¡¨ç¤ºä¸€ä¸ª Unicode æ ‡é‡å€¼ï¼Œæ„å‘³ç€å®ƒæ‰€èƒ½è¡¨ç¤ºçš„è¿œæ¯” ASCII æ›´å¤šã€‚åœ¨ Rust ä¸­ï¼Œæ³•æ–‡å­—ç¬¦ã€ä¸­æ—¥éŸ©å­—ç¬¦ã€emoji åŠé›¶å®½åº¦ç©ºæ ¼éƒ½æ˜¯æœ‰æ•ˆçš„ `char` å€¼ã€‚åŒ…æ‹¬èŒƒå›´ä» `U+0000` åˆ° `U+D7FF` ä»¥åŠ `U+E000` åˆ° `U+10FFFF` çš„ Unicode æ ‡é‡å€¼ã€‚ä¸è¿‡ï¼Œ`character` å¹¶é Unicode ä¸­çš„æ¦‚å¿µï¼Œå› æ­¤ï¼Œç›´è§‚ä¸Šçš„ `character` å¯èƒ½ä¸ Rust ä¸­çš„ `char` ä¸æ˜¯é‚£ä¹ˆåŒ¹é…ã€‚è¯¦ç»†ä»‹ç»å¯å‚è€ƒ [â€œStoring UTF-8 Encoded Text with Stringsâ€](https://doc.rust-lang.org/book/ch08-02-strings.html#storing-utf-8-encoded-text-with-strings) ç« èŠ‚ã€‚

## å¤åˆç±»å‹

å¤åˆç±»å‹å¯å°†å¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªç±»å‹ï¼ŒRust æœ‰ä¸¤ä¸ªåŸºæœ¬å¤åˆç±»å‹ï¼šå…ƒç»„ ( tuples )ã€æ•°ç»„ ( arrays )

### å…ƒç»„ç±»å‹

å…ƒç»„æ˜¯å°†ä¸€äº›ä¸åŒç±»å‹çš„å€¼ç»„åˆåˆ°ä¸€ä¸ªå¤åˆç±»å‹çš„å¸¸è§æ–¹å¼ã€‚å…ƒç»„å…·æœ‰å›ºå®šé•¿åº¦ï¼šä¸€æ—¦å£°æ˜ï¼Œå¤§å°ä¾¿ä¸èƒ½æ›´æ”¹ã€‚

```rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1); // ç±»å‹å£°æ˜å¯é€‰
}
```

#### è®¿é—®å…ƒç»„ä¸­çš„å…ƒç´ 

- åˆ©ç”¨æ¨¡å¼åŒ¹é…å¯¹å…ƒç»„å€¼è¿›è¡Œè§£æ„
- ä½¿ç”¨ç‚¹è¯­æ³•é€šè¿‡ç´¢å¼•è®¿é—®å€¼

```rust
fn main() {
    let tup = (500, 6.4, 1);

    let (x, y, z) = tup; // è§£æ„

    println!("The value of y is: {}", y);
}
```

```rust
fn main() {
    let x: (i32, f64, u8) = (500, 6.4, 1);

    let five_hundred = x.0;

    let six_point_four = x.1;

    let one = x.2;
}
```

### æ•°ç»„ç±»å‹

ä¸åŒäºå…ƒç»„ï¼Œæ•°ç»„ä¸­çš„å…ƒç´ å¿…é¡»å…·æœ‰ç›¸åŒçš„ç±»å‹ï¼ŒRust ä¸­çš„æ•°ç»„ä¸å…¶ä»–è¯­è¨€ä¸­çš„æ•°ç»„æœ‰æ‰€ä¸åŒï¼ŒRust ä¸­çš„æ•°ç»„åƒå…ƒç»„ä¸€æ ·å…·æœ‰å›ºå®šçš„é•¿åº¦ã€‚

```rust
fn main() {
    let a = [1, 2, 3, 4, 5]; // åŒ…å«ç±»å‹æ¨æ–­
}
```

å¦‚æœå¸Œæœ›æ•°æ®å­˜å‚¨åœ¨æ ˆä¸Šè€Œä¸æ˜¯å †ä¸Šï¼Œæˆ–è€…æƒ³è¦ç¡®ä¿æ€»æ˜¯æœ‰å›ºå®šæ•°é‡çš„å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨æ•°ç»„ã€‚å°½ç®¡æ•°ç»„ä¸å¦‚ Vector ç±»å‹çµæ´»ã€‚Vector æ˜¯ä¸€ç§ç”±æ ‡å‡†åº“æä¾›çš„ä¸æ•°ç»„ç±»ä¼¼ä½†å¤§å°å¯å˜çš„é›†åˆç±»å‹ã€‚ä¸ç¡®å®šä½¿ç”¨ Vector è¿˜æ˜¯æ•°ç»„æ—¶ï¼Œä½¿ç”¨ Vector å¯èƒ½æ›´å¥½ä¸€äº›ã€‚

é€‚ç”¨æ•°ç»„çš„åœºæ™¯ï¼š

```rust
// æœˆä»½æ•°æ®æ˜¯å›ºå®šçš„ï¼ŒåŒ…å« 12 ä¸ªå…ƒç´ ï¼Œä¸€æ—¦å®šä¹‰ï¼Œä¸å†éœ€è¦å¢å‡
let months = ["January", "February", "March", "April", "May", "June", "July",
              "August", "September", "October", "November", "December"];
```

ä½¿ç”¨ [type; number] => [å…ƒç´ ç±»å‹ï¼›æ•°ç»„é•¿åº¦] è¯­æ³•æ˜¾å¼å£°æ˜ç±»å‹åŠé•¿åº¦ï¼š

```rust
let a: [i32; 5] = [1, 2, 3, 4, 5];
```

ä¸Šè¿°è¯­æ³•çœ‹èµ·æ¥ç±»ä¼¼æ•°ç»„åˆå§‹åŒ–è¯­æ³•ï¼šå¦‚æœå¸Œæœ›åˆ›å»ºä¸€ä¸ªæ‰€åŒ…å«å…ƒç´ å…·æœ‰ç›¸åŒçš„å€¼çš„æ•°ç»„ï¼Œå¯ä»¥æŒ‡å®šåˆå§‹å€¼ï¼Œåè·Ÿä¸€ä¸ª `;`ï¼Œç„¶åæŒ‡æ˜æ•°ç»„çš„é•¿åº¦ï¼š

```rust
let a = [3; 5]; // ç­‰åŒäº let a = [3, 3, 3, 3, 3]; ä½†æ˜¯è¯­æ³•æ›´ç®€æ´
```

#### è®¿é—®æ•°ç»„å…ƒç´ 

æ•°ç»„æ˜¯åˆ†é…äºæ ˆä¸Šçš„ä¸€å—å•ç‹¬çš„å†…å­˜ï¼Œå¯ä½¿ç”¨ç´¢å¼•æ¥è®¿é—®æ•°ç»„ä¸­çš„å…ƒç´ 

```rust
fn main() {
    let a = [1, 2, 3, 4, 5];

    let first = a[0];
    let second = a[1];
}
```

#### æ— æ•ˆçš„æ•°ç»„å…ƒç´ è®¿é—®

åœ¨è®¿é—®æ— æ•ˆçš„æ•°ç»„å…ƒç´ æ—¶ï¼Œä¼šäº§ç”Ÿè¿è¡Œæ—¶é”™è¯¯ï¼Œè€Œéç¼–è¯‘æ—¶é”™è¯¯ã€‚å½“ä½¿ç”¨ç´¢å¼•è®¿é—®æ•°ç»„å…ƒç´ æ—¶ï¼ŒRust ä¼šæ£€æµ‹ç´¢å¼•æ˜¯å¦å°äºæ•°ç»„é•¿åº¦ï¼Œå¦‚æœç´¢å¼•å¤§äºæˆ–ç­‰äºæ•°ç»„é•¿åº¦ï¼ŒRust ä¼š Panicã€‚

```rust
fn main() {
    let a = [1, 2, 3, 4, 5];
    let index = 10;

    let element = a[index];

    println!("The value of element is: {}", element);
}
```

è¿è¡Œä»£ç ï¼š

```shell
$ cargo run
   Compiling arrays v0.1.0 (file:///projects/arrays)
    Finished dev [unoptimized + debuginfo] target(s) in 0.31 secs
     Running `target/debug/arrays`
thread 'main' panicked at 'index out of bounds: the len is 5 but the index is
 10', src/main.rs:5:19
note: Run with `RUST_BACKTRACE=1` for a backtrace.
```

å¾ˆå¤šä½çº§è¯­è¨€å¹¶ä¸åšæ­¤ç±»æ£€æŸ¥ã€‚ç›¸æ¯”ä½¿ç”¨ä¸æ­£ç¡®çš„ç´¢å¼•æœ‰å¯èƒ½è®¿é—®åˆ°æ— æ•ˆå†…å­˜ï¼ŒRust ä¼šé€šè¿‡ç«‹å³é€€å‡ºä½¿ä½ å…é­æ­¤ç±»é”™è¯¯ã€‚
