<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>字符串 | Rust 学习笔记</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.8bcf7c97.css" as="style"><link rel="preload" href="/assets/js/app.7819f68a.js" as="script"><link rel="preload" href="/assets/js/2.c7e95d31.js" as="script"><link rel="preload" href="/assets/js/16.bfb56dec.js" as="script"><link rel="prefetch" href="/assets/js/10.71b7f3db.js"><link rel="prefetch" href="/assets/js/11.33bb0966.js"><link rel="prefetch" href="/assets/js/12.f7bdb846.js"><link rel="prefetch" href="/assets/js/13.14713a71.js"><link rel="prefetch" href="/assets/js/14.7a72f426.js"><link rel="prefetch" href="/assets/js/15.79443f0e.js"><link rel="prefetch" href="/assets/js/17.c67e5630.js"><link rel="prefetch" href="/assets/js/18.28df6e14.js"><link rel="prefetch" href="/assets/js/19.6dba0f6e.js"><link rel="prefetch" href="/assets/js/20.7fe96ebb.js"><link rel="prefetch" href="/assets/js/21.c1ca2b28.js"><link rel="prefetch" href="/assets/js/22.8d30fb36.js"><link rel="prefetch" href="/assets/js/23.a04d06e6.js"><link rel="prefetch" href="/assets/js/24.8f9dbc43.js"><link rel="prefetch" href="/assets/js/25.1ab69d7f.js"><link rel="prefetch" href="/assets/js/26.9892c271.js"><link rel="prefetch" href="/assets/js/27.e2eb50d5.js"><link rel="prefetch" href="/assets/js/28.31270cab.js"><link rel="prefetch" href="/assets/js/29.e5fde72d.js"><link rel="prefetch" href="/assets/js/3.065ccf56.js"><link rel="prefetch" href="/assets/js/30.80a32322.js"><link rel="prefetch" href="/assets/js/31.827d06ec.js"><link rel="prefetch" href="/assets/js/32.b74942dc.js"><link rel="prefetch" href="/assets/js/33.db15a8db.js"><link rel="prefetch" href="/assets/js/34.343562c8.js"><link rel="prefetch" href="/assets/js/35.c33e3c9f.js"><link rel="prefetch" href="/assets/js/36.61e40180.js"><link rel="prefetch" href="/assets/js/37.907cc52e.js"><link rel="prefetch" href="/assets/js/38.87af5dd2.js"><link rel="prefetch" href="/assets/js/39.4ee57d9f.js"><link rel="prefetch" href="/assets/js/4.4b7d39e7.js"><link rel="prefetch" href="/assets/js/40.8d7408e4.js"><link rel="prefetch" href="/assets/js/41.c2046a9f.js"><link rel="prefetch" href="/assets/js/42.6cc376da.js"><link rel="prefetch" href="/assets/js/43.63a455c5.js"><link rel="prefetch" href="/assets/js/44.0d15d778.js"><link rel="prefetch" href="/assets/js/45.9be4bc9f.js"><link rel="prefetch" href="/assets/js/46.e22e8db9.js"><link rel="prefetch" href="/assets/js/47.dbd72152.js"><link rel="prefetch" href="/assets/js/48.ec6ca506.js"><link rel="prefetch" href="/assets/js/49.22c5f8ae.js"><link rel="prefetch" href="/assets/js/5.3befbe85.js"><link rel="prefetch" href="/assets/js/50.4a58f660.js"><link rel="prefetch" href="/assets/js/51.36d42e96.js"><link rel="prefetch" href="/assets/js/52.2ec659fc.js"><link rel="prefetch" href="/assets/js/53.541947fb.js"><link rel="prefetch" href="/assets/js/54.1cf56973.js"><link rel="prefetch" href="/assets/js/55.27ed2009.js"><link rel="prefetch" href="/assets/js/56.4011a578.js"><link rel="prefetch" href="/assets/js/57.70babd7b.js"><link rel="prefetch" href="/assets/js/58.39568e0b.js"><link rel="prefetch" href="/assets/js/59.98811df6.js"><link rel="prefetch" href="/assets/js/6.fa4dd12d.js"><link rel="prefetch" href="/assets/js/60.c0a0c3f8.js"><link rel="prefetch" href="/assets/js/61.83913c6f.js"><link rel="prefetch" href="/assets/js/62.0ea87c47.js"><link rel="prefetch" href="/assets/js/7.e902d7c9.js"><link rel="prefetch" href="/assets/js/8.ac97398c.js"><link rel="prefetch" href="/assets/js/9.52c69a98.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8bcf7c97.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-navbar"><!----> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/" class="sidebar-link">Rust Note</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>项目管理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>通用编程概念</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/variable.html" class="sidebar-link">变量与可变性</a></li><li><a href="/data-type.html" class="sidebar-link">数据类型</a></li><li><a href="/struct.html" class="sidebar-link">结构体</a></li><li><a href="/enumeration.html" class="sidebar-link">枚举</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/collections/" class="sidebar-heading clickable router-link-active open"><span>集合</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/collections/vector.html" class="sidebar-link">Vector</a></li><li><a href="/collections/string.html" class="active sidebar-link">字符串</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/collections/string.html#字符串的概念" class="sidebar-link">字符串的概念</a></li><li class="sidebar-sub-header"><a href="/collections/string.html#新建" class="sidebar-link">新建</a></li><li class="sidebar-sub-header"><a href="/collections/string.html#更新" class="sidebar-link">更新</a></li><li class="sidebar-sub-header"><a href="/collections/string.html#索引字符串" class="sidebar-link">索引字符串</a></li><li class="sidebar-sub-header"><a href="/collections/string.html#字符串-slice" class="sidebar-link">字符串 slice</a></li><li class="sidebar-sub-header"><a href="/collections/string.html#遍历" class="sidebar-link">遍历</a></li></ul></li><li><a href="/collections/hashmap.html" class="sidebar-link">散列表</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/smart-pointer/" class="sidebar-heading clickable"><span>智能指针</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/function.html" class="sidebar-link">函数</a></li><li><a href="/control-flow.html" class="sidebar-link">流程控制</a></li><li><a href="/error-handling.html" class="sidebar-link">错误处理</a></li><li><a href="/comment.html" class="sidebar-link">注释</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>所有权</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>抽象</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>生命周期</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>并发编程</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>测试</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>模式匹配</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>编程范式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>高级特性</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="字符串"><a href="#字符串" class="header-anchor">#</a> 字符串</h1> <p>字符串（ String ）是由字节的集合以及字节处理方法组合实现的。</p> <p>Rust 中的字符串不如想象中的那样简单是因为：</p> <ul><li>语言对处理数据的要求更严格（ 提前预防错误的产生 ）</li> <li>字符串本身具有复杂性</li> <li>涉及编码问题</li></ul> <h2 id="字符串的概念"><a href="#字符串的概念" class="header-anchor">#</a> 字符串的概念</h2> <p>Rust 核心语言中只有一种字符串类型 <code>str</code>（ 字符串 <code>slice</code> ） ，通常以被借用的形式（ <code>&amp;str</code> ）出现，用来指代一些储存在某处的 <code>UTF-8</code> 编码字符串数据的引用。</p> <p><code>String</code> 类型（ 可增长的、可变的、有所有权的、UTF-8 编码的字符串类型 ）并不属于核心语言类型，而是由标准库提供的。</p> <p>在 Rust 中，谈及字符串通常指 <code>String</code> 和字符串 <code>slice</code> 两种类型，它们都是 <code>UTF-8</code> 编码的。</p> <p>Rust 标准库以及 Crate 中提供了更多与字符串相关的类型，比如 <code>OsString</code>、<code>OsStr</code>、<code>CString</code>、<code>CStr</code>，这些以 <code>String</code> 或是 <code>Str</code> 结尾的命名方式对应了这些字符串类型所提供的所有权和可借用的字符串变体，这些字符串类型能够以不同的编码或内存表现形式存储文本内容。</p> <h2 id="新建"><a href="#新建" class="header-anchor">#</a> 新建</h2> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">// 新建空 String</span>
<span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token string">&quot;initial contents&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 字符串字面值（ 实现了 Display 特质 ）</span>

<span class="token comment">// 3种方式从字符串字面值创建 String</span>
<span class="token keyword">let</span> s <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">&quot;initial contents&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;initial contents&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="更新"><a href="#更新" class="header-anchor">#</a> 更新</h2> <h3 id="附加字符串"><a href="#附加字符串" class="header-anchor">#</a> 附加字符串</h3> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
s<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">&quot;bar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// foobar</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> <span class="token keyword">mut</span> s1 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> s2 <span class="token operator">=</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">;</span>
s1<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// `push_str` 方法参数使用字符串 `slice` 类型，不需要获取所有权</span>

<span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;s2 is {}&quot;</span><span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// `push_str` 方法不获取 s2 的所有权，因此可以正常执行打印</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="附加单独字符"><a href="#附加单独字符" class="header-anchor">#</a> 附加单独字符</h3> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;lo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
s<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">'l'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// lol</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="拼接字符串"><a href="#拼接字符串" class="header-anchor">#</a> 拼接字符串</h3> <h4 id="使用-运算符"><a href="#使用-运算符" class="header-anchor">#</a> 使用 <code>+</code> 运算符</h4> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> s1 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> s2 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;world!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &amp;s2 的类型是 &amp;String 而不是 &amp;str</span>
<span class="token keyword">let</span> s3 <span class="token operator">=</span> s1 <span class="token operator">+</span> <span class="token operator">&amp;</span>s2<span class="token punctuation">;</span> <span class="token comment">// 注意 s1 被移动了，不能继续使用</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>该运算符调用的方法签名类似 <code>fn add(self, s: &amp;str) -&gt; String {...}</code>，表示使用字符串 <code>s2</code> 的引用与字符串 <code>s1</code> 相加。</p> <p><code>&amp;s2</code> 的类型（ <code>&amp;String</code> ）与形参类型（ <code>&amp;str</code> ）不符，编译仍可通过是因为 Rust 将 <code>&amp;s2</code> 强制转换成了 <code>&amp;s2[..]</code>，此操作并没有获取 <code>s2</code> 的所有权，所以操作之后 <code>s2</code> 仍然是有效的。</p> <p>另外，<code>add</code> 获取了 <code>self</code> 的所有权，因为 <code>self</code> 没有使用 <code>&amp;</code>，这意味着 <code>s1</code> 的所有权将被移动到 <code>add</code> 调用中，之后不再有效。所以 <code>let s3 = s1 + &amp;s2;</code> 语句实际上会获取 <code>s1</code> 的所有权，附加上从 <code>s2</code> 中拷贝的内容，并返回结果的所有权。这个实现比多次复制数据更加高效。</p> <h4 id="使用-format-宏"><a href="#使用-format-宏" class="header-anchor">#</a> 使用 <code>format!</code> 宏</h4> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> s1 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;tic&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> s2 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;tac&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> s3 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;toe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 混合了大量 `+` 和 `&quot;` 的表达式不够直观</span>
<span class="token keyword">let</span> s <span class="token operator">=</span> s1 <span class="token operator">+</span> <span class="token string">&quot;-&quot;</span> <span class="token operator">+</span> <span class="token operator">&amp;</span>s2 <span class="token operator">+</span> <span class="token string">&quot;-&quot;</span> <span class="token operator">+</span> <span class="token operator">&amp;</span>s3<span class="token punctuation">;</span>

<span class="token comment">// 使用宏改写更直观！并且不会获取任何参数的所有权！</span>
<span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">&quot;{}-{}-{}&quot;</span><span class="token punctuation">,</span> s1<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> s3<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="索引字符串"><a href="#索引字符串" class="header-anchor">#</a> 索引字符串</h2> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> s1 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> h <span class="token operator">=</span> s1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 报错： Rust 字符串不支持索引</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Rust 字符串不支持索引的原因：</p> <ul><li>字符串索引返回的类型是不明确的，为了避免返回错误值造成隐性 BUG，Rust 的选择是不编译这些代码，防患于未然。</li> <li>性能因素</li></ul> <h3 id="字符串索引返回的类型"><a href="#字符串索引返回的类型" class="header-anchor">#</a> 字符串索引返回的类型</h3> <p>字符串索引可返回类型包括：字节值、字符、字形簇、字符串 <code>slice</code></p> <h4 id="内部存储模式"><a href="#内部存储模式" class="header-anchor">#</a> 内部存储模式</h4> <p><code>String</code> 是一个 <code>Vec&lt;u8&gt;</code> 的封装</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">// 储存字符串的 Vec 的长度是 4 个字节（ 每个字母的 UTF-8 编码占用一个字节 ）</span>
<span class="token keyword">let</span> len <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;Hola&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 储存字符串的 Vec 的长度是 24 个字节（ 使用 UTF-8 编码所需的字节数 ）</span>
<span class="token comment">// 每个 Unicode 标量值需要两个字节存储</span>
<span class="token keyword">let</span> len <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;Здравствуйте&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>字符串字节值的索引并不总是对应一个有效的 <code>Unicode</code> 标量值：</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">// 当使用 UTF-8 编码时，З 的第一个字节 208，第二个是 151</span>
<span class="token comment">// 所以 answer 的值实际上是 208（ 字节索引 0 位置对应的唯一数据 ）</span>
<span class="token comment">// 而 208 并不是期望返回的</span>
<span class="token keyword">let</span> hello <span class="token operator">=</span> <span class="token string">&quot;Здравствуйте&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> answer <span class="token operator">=</span> <span class="token operator">&amp;</span>hello<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 208</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="字节、标量值和字形簇"><a href="#字节、标量值和字形簇" class="header-anchor">#</a> 字节、标量值和字形簇</h4> <p>从 Rust 的角度有三种方式可以理解字符串：字节、标量值和字形簇</p> <p>从字节的角度：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 共有 18 个字节，即计算机最终会储存的数据</span>
<span class="token punctuation">[</span><span class="token number">224</span>, <span class="token number">164</span>, <span class="token number">168</span>, <span class="token number">224</span>, <span class="token number">164</span>, <span class="token number">174</span>, <span class="token number">224</span>, <span class="token number">164</span>, <span class="token number">184</span>, <span class="token number">224</span>, <span class="token number">165</span>, <span class="token number">141</span>, <span class="token number">224</span>, <span class="token number">164</span>,
 <span class="token number">164</span>, <span class="token number">224</span>, <span class="token number">165</span>, <span class="token number">135</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>从 <code>Unicode</code> 标量值的角度：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 类似 Rust 的 char 类型</span>
<span class="token comment"># 共 6 个 `char`，第四个和第六个不是字母，是发音符号，本身并没有任何意义</span>
<span class="token punctuation">[</span><span class="token string">'न'</span>, <span class="token string">'म'</span>, <span class="token string">'स'</span>, <span class="token string">'्'</span>, <span class="token string">'त'</span>, <span class="token string">'े'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>从以字形簇的角度：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 得到人们所说的构成这个单词的四个字母</span>
<span class="token punctuation">[</span><span class="token string">&quot;न&quot;</span>, <span class="token string">&quot;म&quot;</span>, <span class="token string">&quot;स्&quot;</span>, <span class="token string">&quot;ते&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Rust 不关心存储内容是何种人类语言，而是提供了多种方式来解释原始字符串数据，供程序自由选择。</p> <h3 id="性能因素"><a href="#性能因素" class="header-anchor">#</a> 性能因素</h3> <p>索引操作预期总是需要常数时间 <code>O(1)</code>，由于 Rust 需要检查从字符串开头到索引位置的内容来确定有多少有效字符，<code>String</code> 不可能保证这样的性能。</p> <h2 id="字符串-slice"><a href="#字符串-slice" class="header-anchor">#</a> 字符串 <code>slice</code></h2> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> hello <span class="token operator">=</span> <span class="token string">&quot;Здравствуйте&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// s 的类型为 &amp;str, 这些字母长度是两个字节，取字符串的头四个字节结果即为 “Зд”</span>
<span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token operator">&amp;</span>hello<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>尝试获取  <code>&amp;hello[0..1]</code> 将会 panic，与访问 <code>Vector</code> 无效索引的表现一致。</p> <h2 id="遍历"><a href="#遍历" class="header-anchor">#</a> 遍历</h2> <h3 id="从字符串中返回-char-类型的-unicode-标量值"><a href="#从字符串中返回-char-类型的-unicode-标量值" class="header-anchor">#</a> 从字符串中返回 char 类型的  Unicode 标量值</h3> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">// 顺序打印 6 个 char 类型的值</span>
<span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string">&quot;नमस्ते&quot;</span><span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{}&quot;</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="从字符串中返回原始字节"><a href="#从字符串中返回原始字节" class="header-anchor">#</a> 从字符串中返回原始字节</h3> <p>不过需要注意有效的 Unicode 标量值可能会由不止一个字节组成</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">// 打印组成 String 的 18 个字节</span>
<span class="token keyword">for</span> b <span class="token keyword">in</span> <span class="token string">&quot;नमस्ते&quot;</span><span class="token punctuation">.</span><span class="token function">bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{}&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="从字符串中获取字形簇"><a href="#从字符串中获取字形簇" class="header-anchor">#</a> 从字符串中获取字形簇</h3> <p>此操作比较复杂，Rust 标准库并没有提供该功能，如需要可找到供该功能的 Crate</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/collections/vector.html" class="prev">Vector</a></span> <span class="next"><a href="/collections/hashmap.html">散列表</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.7819f68a.js" defer></script><script src="/assets/js/2.c7e95d31.js" defer></script><script src="/assets/js/16.bfb56dec.js" defer></script>
  </body>
</html>
